<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Capstone App</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; display: grid; place-items: center; min-height: 100vh; background: linear-gradient(135deg, #0b1220 0%, #111936 50%, #1a1030 100%); color: #e2e8f0; }
    .card { text-align: center; padding: 2rem 3rem; border-radius: 12px; background: #0e1424; box-shadow: 0 18px 40px rgba(0,0,0,0.45); }
    h1 { margin: 0 0 0.25rem; font-size: 2rem; }
    p { margin: 0.25rem 0 0; color: #94a3b8; }
    .badge { display: inline-block; margin-top: 1rem; padding: 0.35rem 0.6rem; border-radius: 999px; background: #24304a; color: #a5b4fc; font-size: 0.8rem; }
    .calc { margin-top: 1.5rem; background: #0a1020; padding: 1rem; border-radius: 14px; display: inline-block; text-align: left; box-shadow: 0 10px 28px rgba(0,0,0,0.45); width: 100%; max-width: 420px; }
    .display { width: 100%; box-sizing: border-box; padding: 1rem 1.2rem; margin-bottom: 0.9rem; border-radius: 10px; background: #0a0f1f; color: #e2e8f0; border: 1px solid #23304d; font-size: 1.4rem; outline: none; }
    .row { display: grid; grid-template-columns: repeat(4, 3.6rem); gap: 0.7rem; }
    .btn { background: #273046; color: #e5e7eb; border: none; padding: 0.9rem; border-radius: 12px; cursor: pointer; font-weight: 600; transition: transform .06s ease, filter .15s ease; font-size: 1rem; }
    .btn:active { transform: translateY(1px); filter: brightness(1.1); }
    .btn:hover { box-shadow: 0 0 0 2px rgba(139,92,246,0.25), 0 0 18px rgba(139,92,246,0.25); }
    .btn:active { box-shadow: 0 0 0 2px rgba(34,197,94,0.3), 0 0 14px rgba(34,197,94,0.25); }
    .btn.op { background: #8b5cf6; color: #1e1b4b; }
    .btn.equal { background: #22c55e; color: #052e16; grid-column: span 2; }
    .btn.clear { background: #f43f5e; color: #fff; }
    .footer { margin-top: 0.75rem; font-size: 0.8rem; color: #93a3b8; text-align: center; }
    .about { margin-top: 1.5rem; text-align: left; max-width: 720px; margin-inline: auto; }
    
    .wrap { display: grid; grid-template-columns: auto; gap: 1rem; align-items: start; }
    .history { background: #0b1226; border: 1px solid #23304d; border-radius: 12px; padding: 0.75rem; min-height: 8rem; max-height: 14rem; overflow: auto; }
    .history h3 { margin: 0 0 .5rem; font-size: .9rem; color: #7dd3fc; }
    .hist-item { font-size: .9rem; color: #cbd5e1; padding: .3rem .4rem; border-radius: 8px; cursor: pointer; display: flex; justify-content: space-between; gap: .5rem; }
    .hist-item:hover { background: #0a162a; }
    .diagram { margin-top: 1rem; background: #0a1020; border: 1px solid #23304d; border-radius: 12px; padding: 1rem; }
    .diagram svg { width: 100%; height: auto; max-width: 720px; display: block; margin: 0 auto; }
    @media (pointer: coarse) {
      .row { grid-template-columns: repeat(4, 4rem); gap: 0.8rem; }
      .btn { padding: 1.1rem; font-size: 1.1rem; }
      .display { font-size: 1.6rem; padding: 1.2rem 1.3rem; }
      .btn.equal { grid-column: 1 / -1; }
    }
  </style>
</head>
<body>
  <div class="card">
    <h1>Capstone Nginx</h1>
    <p>Deployed via Jenkins → Terraform → EKS</p>
    <div class="badge">v2 - Calculator</div>

    <div class="wrap">
    <div class="calc" aria-label="Simple Calculator">
      <input id="disp" class="display" type="text" inputmode="decimal" placeholder="0" aria-label="calculator display" readonly />
      <div class="row" style="margin-bottom: 0.5rem;">
        <button class="btn clear" data-action="clear">C</button>
        <button class="btn" data-action="back">⌫</button>
        <button class="btn" data-value="%">%</button>
        <button class="btn op" data-value="/">÷</button>
      </div>
  
      <div class="row">
        <button class="btn" data-value="7">7</button>
        <button class="btn" data-value="8">8</button>
        <button class="btn" data-value="9">9</button>
        <button class="btn op" data-value="*">×</button>
      </div>
      <div class="row">
        <button class="btn" data-value="4">4</button>
        <button class="btn" data-value="5">5</button>
        <button class="btn" data-value="6">6</button>
        <button class="btn op" data-value="-">−</button>
      </div>
      <div class="row">
        <button class="btn" data-value="1">1</button>
        <button class="btn" data-value="2">2</button>
        <button class="btn" data-value="3">3</button>
        <button class="btn op" data-value="+">+</button>
      </div>
      <div class="row">
        <button class="btn" data-value="0">0</button>
        <button class="btn" data-value=".">.</button>
        <button class="btn equal" data-action="eval">=</button>
      </div>
      <div class="footer">Supports keyboard: digits, + − × ÷ % .  Enter (=), Backspace (⌫), Esc (C)</div>
      <div class="history" aria-label="Calculation History">
        <h3>History</h3>
        <div id="hist"></div>
      </div>
    </div>
    </div>

  <script>
    (function() {
      const disp = document.getElementById('disp');
      let expr = '';
      const history = [];
      const HMAX = 5;
      const histEl = document.getElementById('hist');
      const histBox = histEl ? histEl.parentElement : null;
      const set = v => { expr = v; disp.value = v || '0'; };
      const renderHist = () => {
        if (!histEl) return;
        histEl.innerHTML = history.map(([e, r], i) => `<div class="hist-item" data-idx="${i}" title="Click to reuse"><span>${e}</span><strong>= ${r}</strong></div>`).join('');
        if (histBox) histBox.style.display = history.length ? 'block' : 'none';
      };
      set('');
      renderHist();

      function safeAppend(val) {
        // prevent multiple operators in a row
        if ('+-*/%'.includes(val)) {
          if (!expr || '+-*/%.'.includes(expr.slice(-1))) return;
        }
        if (val === '.' && (expr.slice(-1) === '.' || /\.\d*$/.test(expr))) {
          // basic dot guard per number segment
        }
        set(expr + val);
      }

      function evaluate() {
        if (!expr) return;
        try {
          // eslint-disable-next-line no-new-func
          const result = Function(`return (${expr})`)();
          const out = String(result);
          // push to history
          history.unshift([expr, out]);
          if (history.length > HMAX) history.pop();
          renderHist();
          set(out);
        } catch(e) {
          set('');
          alert('Invalid expression');
        }
      }

      document.addEventListener('click', e => {
        const b = e.target.closest('button.btn');
        if (!b) return;
        const action = b.getAttribute('data-action');
        const val = b.getAttribute('data-value');
        if (action === 'clear') return set('');
        if (action === 'back') return set(expr.slice(0, -1));
        if (action === 'eval') return evaluate();
        if (val) return safeAppend(val);
      });

      // Click history to reuse result
      histEl.addEventListener('click', e => {
        const item = e.target.closest('.hist-item');
        if (!item) return;
        const idx = +item.getAttribute('data-idx');
        const pair = history[idx];
        if (!pair) return;
        set(pair[1]);
      });

      // Keyboard support
      document.addEventListener('keydown', e => {
        const k = e.key;
        if ((k >= '0' && k <= '9') || k === '.') return safeAppend(k);
        if (['+', '-', '*', '/','%'].includes(k)) return safeAppend(k);
        if (k === 'Enter' || k === '=') { e.preventDefault(); return evaluate(); }
        if (k === 'Backspace') { e.preventDefault(); return set(expr.slice(0, -1)); }
        if (k === 'Escape') { e.preventDefault(); return set(''); }
      });
    })();
  </script>
</body>
</html>
